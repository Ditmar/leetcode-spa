import{j as t,r as u,o as L,p as M}from"./iframe-DbOjZzxb.js";import{B as j,C as D}from"./Button-DgX88-GL.js";import{C as Q}from"./CountdownTimer-9wDNejyJ.js";import{B as l}from"./Box-DzGqqFRv.js";import{T as g}from"./Typography-B-GIPEAP.js";const _=({label:s,selected:n=!1,onClick:i})=>t.jsx(j,{fullWidth:!0,variant:n?"contained":"outlined",color:n?"primary":"inherit",onClick:i,sx:{justifyContent:"flex-start",textTransform:"none",mb:1},children:s});_.__docgenInfo={description:"",methods:[],displayName:"AnswerOption",props:{label:{required:!0,tsType:{name:"string"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const V={"sample-test":{id:"sample-test",title:"Sample LeetCode Test",totalDurationSeconds:1200,questions:[{id:"q1",type:"mcq",title:"¿Cuál es la complejidad temporal de una búsqueda binaria?",description:"Selecciona la opción correcta.",options:[{id:"q1-a",label:"O(1)",value:"O(1)"},{id:"q1-b",label:"O(log n)",value:"O(log n)"},{id:"q1-c",label:"O(n)",value:"O(n)"},{id:"q1-d",label:"O(n log n)",value:"O(n log n)"}]},{id:"q2",type:"code",title:"Suma de dos números",description:"Escribe una función que reciba dos números enteros y retorne su suma.",language:"typescript",starterCode:`function add(a: number, b: number): number {
  // TODO: escribe tu solución aquí
  return 0;
}

export default add;
`,sampleInput:"a = 2, b = 3",expectedOutputDescription:"La función debería devolver 5."}]}};function C(s){return{currentIndex:0,answers:{},remainingSeconds:s?.totalDurationSeconds??0,status:s?"running":"idle",isSubmitting:!1,error:void 0}}async function N(s,n){await N()}function B(s){const[n,i]=u.useState(void 0),[r,o]=u.useState(C()),[f,p]=u.useState(!0),[v,m]=u.useState(void 0);u.useEffect(()=>{p(!0),m(void 0);const e=setTimeout(()=>{const a=V[s];if(!a){m("Test no encontrado"),p(!1),o(C());return}i(a),o(C(a)),p(!1)},300);return()=>clearTimeout(e)},[s]);const T=u.useMemo(()=>{if(n)return n.questions[r.currentIndex]},[n,r.currentIndex]),b=r.currentIndex>0,S=!!n&&r.currentIndex<n.questions.length-1,y=!!n&&r.currentIndex===n.questions.length-1;return{test:n,isLoading:f,error:v,state:r,currentQuestion:T,canGoNext:S,canGoPrevious:b,isLastQuestion:y,handleSelectOption:(e,a)=>{o(c=>({...c,answers:{...c.answers,[e]:a}}))},handleCodeChange:(e,a)=>{o(c=>({...c,answers:{...c.answers,[e]:a}}))},goNext:()=>{S&&o(e=>({...e,currentIndex:e.currentIndex+1}))},goPrevious:()=>{b&&o(e=>({...e,currentIndex:e.currentIndex-1}))},handleSubmit:async()=>{if(n){o(e=>({...e,isSubmitting:!0,error:void 0}));try{await N(n,r.answers),o(e=>({...e,isSubmitting:!1,status:"completed"}))}catch{o(e=>({...e,isSubmitting:!1,error:"No se pudieron guardar las respuestas."}))}}},handleTimeout:()=>{o(e=>({...e,status:"expired",remainingSeconds:0}))}}}const A=({testId:s})=>{const{test:n,state:i,currentQuestion:r,isLoading:o,error:f,canGoNext:p,canGoPrevious:v,isLastQuestion:m,handleSelectOption:T,handleCodeChange:b,goNext:S,goPrevious:y,handleSubmit:w,handleTimeout:I}=B(s),[q,O]=u.useState(!1),E=()=>{O(!0),I()};if(o)return t.jsx(D,{});if(f||!n||!r)return t.jsx(l,{children:t.jsx(g,{color:"error",children:f??"No se pudo cargar el test"})});const P=i.currentIndex,e=n.questions.length,a=i.answers[r.id]??"",c=d=>{T(r.id,d)},k=async()=>{m?await w():S()};return t.jsxs(l,{children:[t.jsx(g,{variant:"h5",children:r.title}),t.jsxs(g,{variant:"body2",color:"text.secondary",children:["Pregunta ",P+1," de ",e]}),t.jsx(l,{mt:2,children:t.jsx(Q,{seconds:n.totalDurationSeconds,onComplete:E})}),t.jsxs(l,{mt:2,children:[r.type==="mcq"&&r.options&&r.options.map(d=>t.jsx(_,{label:d.label,selected:a===d.id,onClick:()=>c(d.id)},d.id)),r.type==="code"&&t.jsxs(l,{children:[t.jsx(g,{variant:"h6",children:"Editor de Código (Simulado)"}),t.jsx("textarea",{placeholder:"Escribe tu código aquí...",style:{width:"100%",height:"150px"},value:i.answers[r.id]??"",onChange:d=>b(r.id,d.target.value)})]})]}),t.jsxs(l,{mt:2,display:"flex",gap:2,children:[t.jsx(j,{variant:"contained",color:"primary",onClick:y,disabled:!v,children:"Anterior"}),t.jsx(j,{variant:"contained",color:"primary",onClick:k,disabled:m?i.isSubmitting:!p,children:m?"Enviar Test":"Siguiente"})]}),q&&t.jsx(g,{mt:2,color:"error",children:"¡Tiempo agotado!"})]})};A.__docgenInfo={description:"",methods:[],displayName:"TestExecutionPage",props:{testId:{required:!0,tsType:{name:"string"},description:`Identificador del test. En el proyecto real seguramente viene de la ruta,
pero aquí lo dejamos como prop para poder testearlo fácilmente.`},onSubmitted:{required:!1,tsType:{name:"signature",type:"function",raw:"(testId: string) => void",signature:{arguments:[{type:{name:"string"},name:"testId"}],return:{name:"void"}}},description:"Callback opcional cuando el test se envía correctamente."}}};const G=M(),z={title:"Pages/TestExecutionPage",component:A,decorators:[s=>t.jsx(L,{theme:G,children:t.jsx(l,{sx:{minHeight:"100vh"},children:t.jsx(s,{})})})],parameters:{layout:"fullscreen"}},x={args:{testId:"sample-test"}},h={args:{testId:"sample-test"},parameters:{viewport:{defaultViewport:"mobile1"}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    testId: 'sample-test'
  }
}`,...x.parameters?.docs?.source}}};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:`{
  args: {
    testId: 'sample-test'
  },
  parameters: {
    viewport: {
      defaultViewport: 'mobile1'
    }
  }
}`,...h.parameters?.docs?.source}}};const H=["MultipleChoiceAndCode","MobileView"],U=Object.freeze(Object.defineProperty({__proto__:null,MobileView:h,MultipleChoiceAndCode:x,__namedExportsOrder:H,default:z},Symbol.toStringTag,{value:"Module"}));export{U as T};
