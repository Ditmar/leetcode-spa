import{r as l,j as t,G as _,v as A}from"./iframe-CW4duQyu.js";import{B as C}from"./Button-8AsQ2IU9.js";import{C as L}from"./CountdownTimer-CNcjWMj6.js";import{C as N}from"./CircularProgress-DUsQBW_F.js";import{B as u}from"./Box-DIIHrGcg.js";import{T as p}from"./Typography-BAdZWHvX.js";const P=({label:o,selected:s=!1,onClick:i})=>t.jsx(C,{fullWidth:!0,variant:s?"contained":"outlined",color:"primary","aria-pressed":s,onClick:i,role:"option",children:o}),k=l.memo(P);P.__docgenInfo={description:"",methods:[],displayName:"AnswerOptionComponent",props:{label:{required:!0,tsType:{name:"string"},description:""},selected:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"MouseEventHandler",elements:[{name:"HTMLButtonElement"}],raw:"MouseEventHandler<HTMLButtonElement>"},description:""}}};const B={"sample-test":{id:"sample-test",title:"Sample LeetCode Test",totalDurationSeconds:1200,questions:[{id:"q1",type:"mcq",title:"¿Cuál es la complejidad temporal de una búsqueda binaria?",description:"Selecciona la opción correcta.",options:[{id:"q1-a",label:"O(1)",value:"O(1)"},{id:"q1-b",label:"O(log n)",value:"O(log n)"},{id:"q1-c",label:"O(n)",value:"O(n)"},{id:"q1-d",label:"O(n log n)",value:"O(n log n)"}]},{id:"q2",type:"code",title:"Suma de dos números",description:"Escribe una función que reciba dos números enteros y retorne su suma.",language:"typescript",starterCode:`function add(a: number, b: number): number {
  // TODO: escribe tu solución aquí
  return 0;
}

export default add;
`,sampleInput:"a = 2, b = 3",expectedOutputDescription:"La función debería devolver 5."}]}};function y(o){return{currentIndex:0,answers:{},remainingSeconds:o?.totalDurationSeconds??0,status:o?"running":"idle",isSubmitting:!1}}async function D(){await new Promise(o=>setTimeout(o,300))}function G(o){const[s,i]=l.useState(void 0),[n,a]=l.useState(y()),[h,m]=l.useState(!0),[v,c]=l.useState(void 0);l.useEffect(()=>{m(!0),c(void 0);const e=setTimeout(()=>{const d=B[o];if(!d){c("Test no encontrado"),m(!1),i(void 0),a(y());return}i(d),a(y(d)),m(!1)},300);return()=>clearTimeout(e)},[o]);const S=l.useMemo(()=>{if(s)return s.questions[n.currentIndex]},[s,n.currentIndex]),f=n.currentIndex>0,b=!!s&&n.currentIndex<s.questions.length-1,T=!!s&&n.currentIndex===s.questions.length-1;return{test:s,isLoading:h,error:v,state:n,currentQuestion:S,canGoNext:b,canGoPrevious:f,isLastQuestion:T,handleSelectOption:(e,d)=>{a(r=>({...r,answers:{...r.answers,[e]:d}}))},handleCodeChange:(e,d)=>{a(r=>({...r,answers:{...r.answers,[e]:d}}))},goNext:()=>{b&&a(e=>({...e,currentIndex:e.currentIndex+1}))},goPrevious:()=>{f&&a(e=>({...e,currentIndex:e.currentIndex-1}))},handleSubmit:async()=>{if(s){a(e=>({...e,isSubmitting:!0})),c(void 0);try{await D(),a(e=>({...e,isSubmitting:!1,status:"completed"}))}catch{a(e=>({...e,isSubmitting:!1})),c("Failed to save answers.")}}},handleTimeout:()=>{a(e=>({...e,status:"expired",remainingSeconds:0}))}}}const M=({testId:o})=>{const{test:s,state:i,currentQuestion:n,isLoading:a,error:h,canGoNext:m,canGoPrevious:v,isLastQuestion:c,handleSelectOption:S,handleCodeChange:f,goNext:b,goPrevious:T,handleSubmit:w,handleTimeout:j}=G(o),I=()=>{j()};if(a)return t.jsx(N,{});if(h||!s||!n)return t.jsx(u,{children:t.jsx(p,{color:"error",children:h??"No se pudo cargar el test"})});const q=i.currentIndex,E=s.questions.length,O=i.answers[n.id]??"",e=r=>{S(n.id,r)},d=async()=>{c?await w():b()};return t.jsxs(u,{children:[t.jsx(p,{variant:"h5",children:n.title}),t.jsxs(p,{variant:"body2",color:"text.secondary",children:["Pregunta ",q+1," de ",E]}),t.jsx(u,{mt:2,children:t.jsx(L,{seconds:s.totalDurationSeconds,onComplete:I})}),t.jsxs(u,{mt:2,children:[n.type==="mcq"&&n.options&&n.options.map(r=>t.jsx(k,{label:r.label,selected:O===r.id,onClick:()=>e(r.id)},r.id)),n.type==="code"&&t.jsxs(u,{children:[t.jsx(p,{variant:"h6",children:"Editor de Código (Simulado)"}),t.jsx("textarea",{placeholder:"Escribe tu código aquí...",style:{width:"100%",height:"150px"},value:i.answers[n.id]??"",onChange:r=>f(n.id,r.target.value)})]})]}),t.jsxs(u,{mt:2,display:"flex",gap:2,children:[t.jsx(C,{variant:"contained",color:"primary",onClick:T,disabled:!v,children:"Anterior"}),t.jsx(C,{variant:"contained",color:"primary",onClick:d,disabled:c?i.isSubmitting:!m,children:c?"Enviar Test":"Siguiente"})]}),i.status==="expired"&&t.jsx(p,{mt:2,color:"error",children:"¡Tiempo agotado!"})]})};M.__docgenInfo={description:"",methods:[],displayName:"TestExecutionPage",props:{testId:{required:!0,tsType:{name:"string"},description:`Identificador del test. En el proyecto real seguramente viene de la ruta,
pero aquí lo dejamos como prop para poder testearlo fácilmente.`},onSubmitted:{required:!1,tsType:{name:"signature",type:"function",raw:"(testId: string) => void",signature:{arguments:[{type:{name:"string"},name:"testId"}],return:{name:"void"}}},description:"Callback opcional cuando el test se envía correctamente."}}};const H=A(),Q={title:"Pages/TestExecutionPage",component:M,decorators:[o=>t.jsx(_,{theme:H,children:t.jsx(u,{sx:{minHeight:"100vh"},children:t.jsx(o,{})})})],parameters:{layout:"fullscreen"}},g={args:{testId:"sample-test"}},x={args:{testId:"sample-test"},parameters:{viewport:{defaultViewport:"mobile1"}}};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:`{
  args: {
    testId: 'sample-test'
  }
}`,...g.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    testId: 'sample-test'
  },
  parameters: {
    viewport: {
      defaultViewport: 'mobile1'
    }
  }
}`,...x.parameters?.docs?.source}}};const V=["MultipleChoiceAndCode","MobileView"],U=Object.freeze(Object.defineProperty({__proto__:null,MobileView:x,MultipleChoiceAndCode:g,__namedExportsOrder:V,default:Q},Symbol.toStringTag,{value:"Module"}));export{U as T};
